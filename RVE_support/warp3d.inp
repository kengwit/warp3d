!
!     3D rectangular prism RVE. Lx = 1, Ly = 2, Lz = 4
!     
!     Periodic boundary conditions (PBCs) applied to enforce the
!     RVE macroscale strain tensor:
!
!        0.1 0.2 0.5  #   eps_xx,  eps_xy,  eps_xz  
!        0.2 0.0 0.3  #   eps_xy,  eps_yy,  eps_yz
!        0.5 0.3 0.0          
!
!    *****    Note    *****
!    
!         WARP3D outputs the engineering definition of shear strains, i.e.,
!         gamma_xy, gamma_yz, gamma_xz 
!         The printed results should thus be gamma_xy = 0.4, 
!         gamma_yz = 0.6 and gamma_xz_ = 1.0
!
 material steel
    properties mises e 30000  nu 0.3 n_power 10 yld_pt 60.e10  $ linear-elastic
!
 material rve_link
     properties link stiff_link 1.0e10 mass_link 0.0
!
 structure prism
! 
 number of nodes 35 elements 12
!
 elements
  1-8 type l3disop linear material steel order 2x2x2 bbar,
                          center_output short
  9 10 11 12 type link2 material rve_link
! 
*input from file "coords_incid.inp"
*echo on
!
 blocking automatic 
!
 *input from file 'rve_generated_constraints.inp'
!
 loading test
  nonlinear
    step 1 constraints 1.0
! 
 nonlinear analysis parameters $ only those really needed here
   solution technique sparse direct 
   time step 1.0e06 
   maximum iterations 5 $ global Newton iterations
   minimum iterations 1
   convergence test norm res tol 0.001
   batch messages off
   trace solution on
! 
 output model flat patran convention text file "model"
!
 compute displacements for loading test step  1
 output wide strains 1-8
 output wide stresses 1-12
 output wide displacements 1-35
! output flat text displacements     $ for ParaView visualization
! output flat text element stresses  $ for ParaView visualization
!
stop
