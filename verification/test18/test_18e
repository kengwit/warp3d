c
c
c    high-rate, ductile crack growth in a shallow notch se(b)
c    =======================================================                  
c 
c            W=2 in,  span/2=4 in, B=0.001 in, a/W=0.15
c            uses crack growth by element extinction
c            with Gurson material model
c 
c    nonlinear material, large displacements, bbar,
c    large amounts of ductile crack growth with the Gurson-
c    Tvergaard material model. the finite element model
c    has one-layer of elements with w=0 constraints everywhere
c    to impose plane-strain conditions.
c
c    Plastic response for Gurson cells and background (dense) material
c    is strongly sensitive to strain rate defined through a set of
c    segmental stress-plastic strain curves at various
c    plastic strain rates
c
c    the mass density is set to zero and the time step is small
c    (0.5 milli-secs). this removes inertial effects from the 
c    solution but includes rate dependent material response.
c
c    computational "cell" size is D=200 um. due to symmetry then
c    the elements in the Gurson layer are 100 um x 100 um in size. 
c
c    we intentionally use large increments of imposed displacements
c    at the load point to create severe conditions for the
c    material model integration schemes and the adaptive solution
c    procedures. plastic strain rates reach 1500.
c
c    the algorithms are designed to do whatever adaptivity
c    is required to push forward with the solution. the user
c    can then re-analyze the model with a much more realistic
c    (smaller) load step size.
c
c    J-integral values are computed occasionally during loading.
c
c    a restart file is also written along the way after every
c    10 or so load increments.
c
c    here we employ catastrophic, strain-controlled nucleation
c    to smoothly relax stresses in elements just prior to 
c    actually killing them.
c
c    the material in linear + power law with n=10, E/sig-0=500,
c    nu=0.3. initial porosity in the cell is 0.005.
c    
structure seb
c
 stress-strain curve 1 plastic strain-rate 500
  0.0   80,   $ these are plastic strain vs. stress values
  0.025 96,   $ the first point must have zero plastic strain...
  0.050 103,
  0.10  108,
  0.20  114,
  0.30  118,
  0.40  122,
  100   1000
c
 stress-strain curve 2 plastic strain-rate 300
  0.0   70,
  0.025 85,
  0.050 91,
  0.10  96,
  0.20  102,
  0.30  105,
  0.40  108,
  100   1000
c
 stress-strain curve 3 plastic strain-rate 100 
  0.0   60,
  0.025 74,
  0.050 79,
  0.10  83,
  0.20  88,
  0.30  91,
  0.40  93,
  100   1000
c
material steel 
  properties  mises  e 30000.  nu 0.3  curves 1-3 rho 0.0
c
material void_strip
 properties gurson e 30000 nu 0.3 curves 1-3,
            f_0 0.005 q1 1.25 q2 1.0 q3 1.5625,
            killable, e_n 0.4 s_n 0.05 f_n 0.50 nucleation,
            rho  0.0
c
number of nodes 1568 elements 715
c
elements
   1-60 type l3disop nonlinear material void_strip order 2x2x2,
             bbar center_output 
   61-715 type l3disop nonlinear material steel order 2x2x2,
               bbar center_output 
c
*input from "coords.inp"
*input from "incid.inp"
*input from "constraints.inp"               
c
 blocking automatic
c
 loading bend
  nonlinear
    step 1-60 constraints 0.002 $inches
c
  nonlinear analysis parameters
   solution technique direct sparse 
   adaptive solution on
   maximum iterations 5
   convergence test norm res tol 0.005 $ rather tight
   line search on details
   time step 0.0005
   trace solution on
   extrapolate on  $ really helps convergence rate
   consistent q-matrix off  $ on -> nonconvergence
   bbar stabilization factor 0.0
c
  crack growth parameters
   type of crack growth gurson
   print status on order  1 31 2 32 3 33 4 34 5 35 6 36 7 37 8 38,
                         9 39 10 40 11 41 12 42 13 43 14 44 15 45,
                        16 46 17 47 18 48 19 49 20 50
   kill sequentially on order 1 31 2 32
   force release type traction-separation
   crack plane normal y coord 0.0
   cell height 0.004
   release fraction 0.1
   critical porosity 0.2
c
   output J-values use file "test_18_get_j.inp" steps 30 40 50 60
   output commands use file "get_output_18.inp" steps 10 20 
c
 compute displacements for loading bend step 60
c
  stop

