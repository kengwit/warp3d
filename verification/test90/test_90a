!
!     3D rectangular prism RVE. Lx = 1, Ly = 2, Lz = 4
!     
!     Periodic boundary conditions (PBCs) applied to enforce the
!     RVE macroscale strain tensor:
!
!        0.1 0.2 0.5  #   eps_xx,  eps_xy,  eps_xz  alternate notation: eps_11,  eps_12,  eps_13
!        0.2 0.0 0.3  #   eps_xy,  eps_yy,  eps_yz
!        0.5 0.3 0.0          
!
!    *****    Note    *****
!    
!         WARP3D outputs the engineering definition of shear strains, i.e.,
!         gamma_xy, gamma_yz, gamma_xz 
!         The printed results should thus be gamma_xy = 0.4, 
!         gamma_yz = 0.6 and gamma_xz_ = 1.0
!
 material steel
    properties mises e 30000  nu 0.3 n_power 10 yld_pt 60.e10  $ linear-elastic
!
 material rve_link
     properties link stiff_link 1.0e10 mass_link 0.0
!
 structure prism
! 
 number of nodes 35 elements 12
!
 elements
  1-8 type l3disop linear material steel order 2x2x2 bbar,
                          center_output short
  9 10 11 12 type link2 material rve_link
! 
 coordinates
*echo off
 1   0.0   0.0   0.0
 2   0.5   0.0   0.0
 3   1.0   0.0   0.0
 4   0.0   1.0   0.0
 5   0.5   1.0   0.0
 6   1.0   1.0   0.0
 7   0.0   2.0   0.0
 8   0.5   2.0   0.0
 9   1.0   2.0   0.0
10   0.0   0.0   2.0
11   0.5   0.0   2.0
12   1.0   0.0   2.0
13   0.0   1.0   2.0
14   0.5   1.0   2.0
15   1.0   1.0   2.0
16   0.0   2.0   2.0
17   0.5   2.0   2.0
18   1.0   2.0   2.0
19   0.0   0.0   4.0
20   0.5   0.0   4.0
21   1.0   0.0   4.0
22   0.0   1.0   4.0
23   0.5   1.0   4.0
24   1.0   1.0   4.0
25   0.0   2.0   4.0
26   0.5   2.0   4.0
27   1.0   2.0   4.0
     28 10 10 10
     29 10 10 10
     30 10 10 10
     31 10 10 10
     32 10 10 10
     33 10 10 10
     34 10 10 10
     35 10 10 10
!
 incidences
       1       1       2       5       4      10      11      14      13
       2       2       3       6       5      11      12      15      14
       3       4       5       8       7      13      14      17      16
       4       5       6       9       8      14      15      18      17
       5      10      11      14      13      19      20      23      22
       6      11      12      15      14      20      21      24      23
       7      13      14      17      16      22      23      26      25
       8      14      15      18      17      23      24      27      26
       9  28 29
       10 30 31
       11 32 33
       12 34 35
*echo on
!
 blocking automatic 
!
 constraints
! 
  1 u 0.0  v 0.0  w 0.0  
!
!                       $ non-zero displacements on dummy nodes are
!                       $ sufficient to prevent rigid rotations  
!
! set node 29 u = eps_11 value
! set node 31 u, v = eps_12 value
! set node 33 u, w = eps_13 value
! set node 35 u, w = eps_23 value
!
   29   u 0.1  v  0.0  w 0.0
   31   u 0.2  v  0.2  w 0.0
   33   u 0.5  v  0.0  w 0.5
   35   u 0.0  v  0.3  w 0.3  
!
 multipoint
!
  15 1.0 u  - 13 1.0 u  - 28 1.0 u = 0.
  15 1.0 v  - 13 1.0 v  - 30 1.0 v = 0.
  15 1.0 w  - 13 1.0 w  - 32 1.0 w = 0.
  17 1.0 u  - 11 1.0 u  - 30 2.0 u = 0.
  17 1.0 v  - 11 1.0 v = 0.
  17 1.0 w  - 11 1.0 w  - 34 2.0 w = 0.
  23 1.0 u  - 5 1.0 u  - 32 4.0 u = 0.
  23 1.0 v  - 5 1.0 v  - 34 4.0 v = 0.
  23 1.0 w  - 5 1.0 w = 0.
  18 1.0 u  - 10 1.0 u  - 28 1.0 u  - 30 2.0 u = 0.
  18 1.0 v  - 10 1.0 v  - 30 1.0 v = 0.
  18 1.0 w  - 10 1.0 w  - 32 1.0 w  - 34 2.0 w = 0.
  12 1.0 u  - 16 1.0 u  - 28 1.0 u  + 30 2.0 u = 0.
  12 1.0 v  - 16 1.0 v  - 30 1.0 v = 0.
  12 1.0 w  - 16 1.0 w  - 32 1.0 w  + 34 2.0 w = 0.
  24 1.0 u  - 4 1.0 u  - 28 1.0 u  - 32 4.0 u = 0.
  24 1.0 v  - 4 1.0 v  - 30 1.0 v  - 34 4.0 v = 0.
  24 1.0 w  - 4 1.0 w  - 32 1.0 w = 0.
  6 1.0 u  - 22 1.0 u  - 28 1.0 u  + 32 4.0 u = 0.
  6 1.0 v  - 22 1.0 v  - 30 1.0 v  + 34 4.0 v = 0.
  6 1.0 w  - 22 1.0 w  - 32 1.0 w = 0.
  26 1.0 u  - 2 1.0 u  - 30 2.0 u  - 32 4.0 u = 0.
  26 1.0 v  - 2 1.0 v  - 34 4.0 v = 0.
  26 1.0 w  - 2 1.0 w  - 34 2.0 w = 0.
  8 1.0 u  - 20 1.0 u  - 30 2.0 u  + 32 4.0 u = 0.
  8 1.0 v  - 20 1.0 v  + 34 4.0 v = 0.
  8 1.0 w  - 20 1.0 w  - 34 2.0 w = 0.
  27 1.0 u  - 28 1.0 u  - 30 2.0 u  - 32 4.0 u = 0.
  27 1.0 v  - 30 1.0 v  - 34 4.0 v = 0.
  27 1.0 w  - 32 1.0 w  - 34 2.0 w = 0.
  9 1.0 u  - 19 1.0 u  - 28 1.0 u  - 30 2.0 u  + 32 4.0 u = 0.
  9 1.0 v  - 19 1.0 v  - 30 1.0 v  + 34 4.0 v = 0.
  9 1.0 w  - 19 1.0 w  - 32 1.0 w  - 34 2.0 w = 0.
  25 1.0 u  - 3 1.0 u  + 28 1.0 u  - 30 2.0 u  - 32 4.0 u = 0.
  25 1.0 v  - 3 1.0 v  + 30 1.0 v  - 34 4.0 v = 0.
  25 1.0 w  - 3 1.0 w  + 32 1.0 w  - 34 2.0 w = 0.
  21 1.0 u  - 7 1.0 u  - 28 1.0 u  + 30 2.0 u  - 32 4.0 u = 0.
  21 1.0 v  - 7 1.0 v  - 30 1.0 v  - 34 4.0 v = 0.
  21 1.0 w  - 7 1.0 w  - 32 1.0 w  + 34 2.0 w = 0.
!
 loading test
  nonlinear
    step 1 constraints 1.0
! 
 nonlinear analysis parameters $ only those really needed here
   solution technique sparse direct 
   time step 1.0e06 
   maximum iterations 5 $ global Newton iterations
   minimum iterations 1
   convergence test norm res tol 0.001
   batch messages off
   trace solution on
! 
 output model flat patran convention text file "model"
!
 compute displacements for loading test step  1
 output wide strains 1-8
 output wide stresses 1-12
 output wide displacements 1-35
! output flat text displacements     $ for ParaView visualization
! output flat text element stresses  $ for ParaView visualization
!
stop
